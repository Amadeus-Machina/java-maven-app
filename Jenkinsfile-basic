pipeline {
    agent any
    tools {
        maven: 'maven'

    }

    stages {
        
        stage("build jar") {
            steps {
                script {
                        echo 'building jar file'
                        sh 'mvn package' 
                }
              
            }
        }
        stage("build docker image") {
            steps{
                script{
           
            withCredentials([usernamePassword(credentialsId: 'Docker_hub', passwordVariable:        'pass', usernameVariable: 'USER')])
             sh 'docker build -t ahmedabed/demo-app:4.0 .'
             sh " echo $pass | docker login -u $USER --password-stdin"
             sh ' docker push ahmedabed/demo-app:4.0'
                }
            }
           


            }
        }
        
      
}
